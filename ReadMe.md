# [TDD] 테스트의 필요성과 

## 단위테스트와 통합테스트의 차이

---
### [단위 테스트(Unit Test)]

 **✏️ 단위테스트(unit test)**   
     하나의 모듈을 기준을 독립적으로 진행되는 가장 작은 단위의 테스트
> 🔎 모듈은 애플리케이션에서 작동하는 하나의 기능 또는 메소드로 이해 할 수 있다.

### [통합 테스트(Integration Test)]

**✏️ 통합테스트(Integration test)**   
모듈을 통합하는 과정에서 모듈 간의 호환성을 확인하기 위해 수행되는 테스트
> 🔎 일반적으로 어플리케이션은 여러 모듈과 메시지를 주고 받으면서 상호작용을 한다. 그렇기에 통합적으로 모듈들이 원활하게 돌아가는지
> 확인하기 위한 검증이 필요하기 때문에 사용


## 단위 테스트 작성의 필요성

---
### [단위 테스트(Unit Test) 작성의 필요성]

> 📚통합 테스트는 전체를 테스트를 진행하기 때문에 한번의 테스트에 많은 자원을 사용한다.   
> 단위 테스트는 해당 부분만 독립적으로 테스트하기 때문에 어떤 코드를 리팩토링하여도 적은 비용으로 문제 여부를 확인 할 수 있다.

 - 테스팅에 대한 시간과 비용을 절감할 수 있다.
 - 새로운 기능 추가 시에 수시로 빠르게 테스트 할 수 있다.
 - 리팩토링 시에 안정성을 확보할 수 있다.
 - 코드에 대한 문서가 될 수 있다.

### [단위 테스트(Unit Test)의 문제점]

- 가짜 객체 를 주입하여 어떤 결과를 반환하라고 정해진 답변을 준비 시켜야한다. -> **stub**라고 부름

### [좋은 단위 테스트(Unit Test)]

- 변경된 코드를 검증 가능한 테스트 코드를 만들자.
  - 1개의 테스트 함수에 대해 assert를 최소화하라
  - 1갱의 테스트 함수는 1가지 개념 만을 테스트 하라

- 깨끗한 테스트 코드 FIRST 5규칙을 따르자.
  - Fast :  테스트는 빠르게 동자하여 자주 돌릴 수 있어야 함
  - Independent: 가각의 테스트는 독립적이며 서로 의존해서는 안된다.
  - Repeatable: 어느 환경에서도 반복이 가능해야한다.
  - Self-Validation: 테스트는 성공 또는 실패로 bool 값으로 내어 자체적으로 검증되어야 한다.
  - Timely: 테스트는 적시에 즉, 테스트하려는 실제 코드를 구현하기 직전에 구현해야한다.


## Mockito 소개 및 사용법

---

### [Mockito이란?]

**✏️ Mockito**
spring 을 이용한 웹 어플리케이션을 개발하면, 여러 객체들 간의 의존성이 생긴다. 이러한 의존성은 단위 테스트를 어렵한다.   
이를 해결하기 위해 가짜 객체를 주입시키는 Mockito 라이버를 활용한다.
> 🔎  개발자가 동작을 직접 제어할 수 있는 가짜 객체를 지원하는 테스트 프레임워크

*gradle*  
```groovy
testImplementation group: 'org.springframework', name: 'spring-mock', version: '2.0.8'
```

### [ Mockito 사용법 ]
### 1. Mock 객체 의존성 주입

- @Mock: 가짜 객체를 만들어 반환해주는 어노테이션
- @Spy: Stub하지 않은 메소드들은 원본 메소드 그대로 사용하는 어노테이션
- @InjectMocks: @Mock 또는 @Spy로 생성된 가짜 객체를 자동으로 주입시켜주는 어노테이션


예를 들어 UserController에 대한 단위 테스트를 작성하고자 할 때, UserService를 사용하고 있다면 @Mock 어노테이션을 통해 가짜 UserService를 만들고, @InjectMocks를 통해 UserController에 이를 주입시킬 수 있다.



### 2. Stub로 결과 처리
   앞서 설명하였듯, 의존성이 있는 객체는 가짜 객체를 주입하여 어떤 결과를 반환하라고 정해진 답변을 준비시켜야 한다. Mockito에서는 다음과 같은 stub 메소드를 제공한다.

- doReturn(): 가짜 객체가 특정한 값을 반환해야 하는 경우
- doNothing(): 가짜 객체가 아무 것도 반환하지 않는 경우(void)
- doThrow(): 가짜 객체가 예외를 발생시키는 경우






### 3. Mockito와 Junit의 결합
   Mockito도 테스팅 프레임워크이기 때문에 JUnit과 결합되기 위해서는 별도의 작업이 필요하다. 기존의 JUnit4에서 Mockito를 활용하기 위해서는 클래스 어노테이션으로 @RunWith(MockitoJUnitRunner.class)를 붙여주어야 연동이 가능했다. 하지만 SpringBoot 2.2.0부터 공식적으로 JUnit5를 지원함에 따라, 이제부터는 @ExtendWith(MockitoExtension.class)를 사용해야 결합이 가능하다.

# ⛓참고자료

- ️https://mangkyu.tistory.com/143
- https://mangkyu.tistory.com/145